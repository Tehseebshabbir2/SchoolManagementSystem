<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Classes | School Management System</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="media qeure.css">
</head>
<body>
<header class="header">
        <div class="half-header">
<div class="logo">
    <img src="icon.png" alt="">
    <h1>School Management System</h1>
</div>
</div>
<div class="half-header2">
   <button class="add-btn" onclick="openModal()">+ Add Student</button>
 </div>
    </header>
    <div class="main-classes">
    <div class="sidebar">
  <nav>
    <ul>
      <li><a href="index.html">Dashbord</a></li>
      <li><a href="user.html">Users</a></li>
      <li><a href="class.html">Classes</a></li>
      <li><a href="subject.html">Subjects</a></li>
      <li><a href="">Students</a></li>
      <li><a href="admission.html">Admission</a></li>
     
    </ul>
  </nav>
</div>
  <div class="container">
    <div class="search-container">
  <input type="text" id="searchInput" placeholder="Search Student ID..." onkeyup="searchClass()" />

</div>

    <table>
      <thead>
        <tr>
          <th>Student Id</th>
          <th>Student Name</th>
          <th>Class</th>
          <th>phone #</th>
          <th>Address</th>
          <th>Acation</th>
        </tr>
      </thead>
      <tbody id="classTable">
      </tbody>
    </table>
  </div>
</div>
  <div id="classModal" class="modal">
    <div class="modal-content">
      <h3>Add New Class</h3>
      <input type="text" id="studentid" placeholder="student Id" />
      <input type="text" id="studentname" placeholder="Student name" />
      <input type="text" id="teacher" placeholder="Class Teacher Name" />
      <input type="text" id="phone" placeholder="phone #" />
      <input type="text" id="adress" placeholder="Adress" />
      <button onclick="addClass()">Add Class</button>
    </div>
  </div>
 <script>
  let editIndex = null;

 
  window.onload = function () {
    const data = JSON.parse(localStorage.getItem("students")) || [];
    data.forEach((student, index) => {
      insertRow(student, index);
    });
  };

  function openModal() {
    document.getElementById("classModal").style.display = "block";
  }

  window.onclick = function (event) {
    const modal = document.getElementById("classModal");
    if (event.target == modal) {
      modal.style.display = "none";
    }
  };

  function getFormData() {
    return {
      id: document.getElementById("studentid").value,
      name: document.getElementById("studentname").value,
      class: document.getElementById("teacher").value,
      phone: document.getElementById("phone").value,
      address: document.getElementById("adress").value
    };
  }

  function clearForm() {
    document.getElementById("studentid").value = '';
    document.getElementById("studentname").value = '';
    document.getElementById("teacher").value = '';
    document.getElementById("phone").value = '';
    document.getElementById("adress").value = '';
  }

  function insertRow(student, index) {
    const table = document.getElementById("classTable");
    const row = table.insertRow();
    row.innerHTML = `
      <td>${student.id}</td>
      <td>${student.name}</td>
      <td>${student.class}</td>
      <td>${student.phone}</td>
      <td>${student.address}</td>
      <td>
        <button onclick="editRow(${index})" class="crud-btn">Edit</button>
        <button onclick="deleteRow(${index})" class="crud-btn">Delete</button>
      </td>
    `;
  }

  function refreshTable() {
    const table = document.getElementById("classTable");
    table.innerHTML = "";
    const data = JSON.parse(localStorage.getItem("students")) || [];
    data.forEach((student, index) => {
      insertRow(student, index);
    });
  }

  function addClass() {
    const student = getFormData();
    let data = JSON.parse(localStorage.getItem("students")) || [];

    if (editIndex !== null) {
     
      data[editIndex] = student;
      editIndex = null;
    } else {
      
      data.push(student);
    }

    localStorage.setItem("students", JSON.stringify(data));
    document.getElementById("classModal").style.display = "none";
    clearForm();
    refreshTable();
  }

  function deleteRow(index) {
    let data = JSON.parse(localStorage.getItem("students")) || [];
    data.splice(index, 1);
    localStorage.setItem("students", JSON.stringify(data));
    refreshTable();
  }

  function editRow(index) {
    let data = JSON.parse(localStorage.getItem("students")) || [];
    const student = data[index];

    document.getElementById("studentid").value = student.id;
    document.getElementById("studentname").value = student.name;
    document.getElementById("teacher").value = student.class;
    document.getElementById("phone").value = student.phone;
    document.getElementById("adress").value = student.address;

    openModal();
    editIndex = index;
  }

  function searchClass() {
    const input = document.getElementById("searchInput").value.toLowerCase();
    const rows = document.querySelectorAll("#classTable tr");
    let found = false;

    rows.forEach(row => {
      const studentId = row.cells[0].textContent.toLowerCase();
      if (studentId.includes(input)) {
        row.style.display = "";
        found = true;
      } else {
        row.style.display = "none";
      }
    });

    if (!found && input.trim() !== "") {
      alert("Student ID not found!");
    }
  }
</script>


</body>
</html>
